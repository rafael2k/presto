<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <meta content="HTML Tidy for Linux/x86 (vers 11 February 2007), see
  www.w3.org" name="generator" />
  <!-- processor: http://www.w3.org/Style/Group/css3-src/bin/postprocess -->

  <title>Test Suite for Widget Interface</title>

  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet"
  type="text/css" />

 </head>

<body>
<div class="head">
   <p><a href="http://www.w3.org/"><img alt="W3C" height="48"
    src="http://www.w3.org/Icons/w3c_home" width="72" /></a></p>
   <!--end-logo--> <!--end-logo-->
<h1 class="head"> Test Suite for the <cite>Digital Signatures For Widgets</cite> Specification  </h1>
<dl>
   <dt>Lead test-case creator: </dt>
     <dd><a href="http://stuartk.co.uk/">Stuart Knightley</a>, Opera Software ASA </dd>

     <dt>Tools contributors:</dt>
     <dd><a href="http://hendry.iki.fi/">Kai Hendry</a>, Aplix Corporation</dd>
<dd><a href="http://stuartk.co.uk/">Stuart Knightley</a>, Opera Software ASA </dd>
     <dt>Maintainer:</dt>
     <dd><a href="http://datadriven.com.au/">Marcos CÃ¡ceres</a>, Opera Software ASA  </dd>
   </dl>
  <p class="copyright"><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    &copy; 2010 <a href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a
    href="http://www.ercim.org/"><acronym title="European Research Consortium
    for Informatics and Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>

    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
</div>
<hr />
<h2 id="prologue">Prologue</h2>
 <p>This document provides an overview of the test suite for the  <a href="http://www.w3.org/TR/widgets-digsig/"><cite>Digital Signatures For Widgets</cite></a> specification. The Working Group
  has developed this test suite so to have a test case for every conformance requirement in the specification.</p>
<p>The Working Group encourages the public and members to contribute tests.</p>
<h2>Status of this Test Suite</h2>
 <p><strong>This is the first release of this test suite: this test suite is unstable and subject to change.</strong> The WebApps WG has sought review of the test cases from members of XMLSec and WebApps, the community at large, as well as any vendors who are implementing. The deadline for comment is the 30th of September. We are particularly interested in feedback on the completeness of testing (i.e., have we tested enough? do we need more tests)? Can the test suite actually be run on devices and runtimes? All and any comments are welcomed! Please send feedback to <a href="mailto:public-webapps@w3.org">public-webapps</a>.</p>
 <h2>Licenses</h2>
<p>This test suite is distributed under the <a
href="http://www.w3.org/Consortium/Legal/2008/04-testsuite-copyright">W3C test
suite licensing scheme</a>. Note that claims of performance can only be made
against unaltered tests. The Working Group encourages the public and W3C
members to contribute tests. To contribute to a W3C Test Suite, see the <a
href="http://www.w3.org/2004/10/27-testcases">policies and contribution
forms</a>.</p>
<h2 id="introduction">Introduction</h2>
<p>The tests in this test suite, and supporting material, are all designed as
  much as possible to test only the features required for a user agent to
  conform to the specification. </p>
<h3 id="user-agent-requirements2">Method used for testing </h3>
<p>This specification makes use of the guidelines described in  <cite><a href="http://www.w3.org/TR/test-methodology/">A Method for Writing Testable Conformance Requirements</a></cite>. Please refer to that document for terminology and the approach that was taken to create this test suite. </p>
<h3 id="user-agent-requirements">User Agent
 Requirements</h3>
<p>Please note that this specification targets the three products identified in the specfication:</p>
<ul>
  <li>Signer </li>
  <li>Verifier</li>
  <li>Implementaton</li>
</ul>
<p>Each user agent is subtly different.</p>
<h3 id="pampc-test-templates0">Test file template</h3>
 <p>The <a href="test-cases/template"><dfn>test file template</dfn></a> contains
  a <code>LICENSE</code> file, which should be signed,
  a simple <code>config.xml</code> file labelled with the test ID, and assertion ID,
  an <code>index.html</code> also labelled with the test and assertion IDs, with the background
  colour set to green is the test is expected to pass, red if it is expected to fail,
  and grey if the result needs to be verified externally.</p>

 <p>To create a test, download the tools from the <a href="tools/">tools/ directory</a>,
  the keys and certificates from the <a href="keys/">keys/ directory</a>
  and the <a href="test-cases/template">template directory</a>. Use the
  <code>create-test-case.sh</code> script with the assertion ID and the new test ID,
  for example: <kbd>./create-test-case.sh ta-1 1a</kbd>. The tools are discussed
  further in the next section.</p>

 <h4>Signature IDs</h4>
 <p>For testing purposes the <code>dsp:Identifier</code> value for the signatures follows a
  common format.</p>
 <dl>
  <dt><code>author-signature.xml</code></dt>
  <dd><pre>w3c-testsuite-id-<em>&lt;assertion id&gt;</em>-<em>&lt;test id&gt;</em>-author</pre></dd>
  <dt><code>signature1.xml</code></dt>
  <dd><pre>w3c-testsuite-id-<em>&lt;assertion id&gt;</em>-<em>&lt;test id&gt;</em></pre></dd>
  <dt><code>signature<em>&lt;2..&gt;</em>.xml</code></dt>
  <dd><pre>w3c-testsuite-id-<em>&lt;assertion id&gt;</em>-<em>&lt;test id&gt;</em>-<em>&lt;2..&gt;</em></pre></dd>
 </dl>
 <p>For example the distributor signature identifier for <code>signature1.xml</code>
 for <code>ta-3</code> with test ID <code>3a</code> would be <code>w3c-testsuite-id-ta-3-3a</code>.</p>

 <h3>Test suite tools</h3>
 <p>Several tools are available to aid the creation and validation of widgets.
  They take the form of several bash scripts and have the following package dependencies:</p>
 <ul>
  <li>uuid</li>
  <li>xmlsec >= 1.2.13
   <p>At the time of writing this needs to be compiled from source, and requires
    the following libraries:</p>
   <ul>
    <li>libxml2-dev</li>
    <li>libxslt1-dev</li>
    <li>libssl-dev</li>
   </ul>
  </li>
  <li>xmlstarlet</li>
  <li>rnv</li>
  <li>openssl</li>
 </ul>

 <h4>create-test-case.sh</h4>
 <p>This tool will create a new test case by performing the following steps:</p>
 <ol>
  <li>Create a new directory under the test-cases/ directory called
   <code>&lt;ASSERTION ID&gt;/&lt;TEST ID&gt;/</code></li>
  <li>Copy the files from test-cases/template/</li>
  <li>Replace the ID place holders with the assertion ID and test ID</li>
  <li>Create an author and two distributor signatures using the default key,
   <code>3.rsa.p12</code></li>
 </ol>
 <p>If you wish to use a different key/certificate, then delete the automatically created
  signatures and use sign-widget.sh to create new signatures.</p>

 <h4>sign-widget.sh</h4>
 <p>This tool will create author and distributor signatures for a widget (either
  zipped or in a directory).</p>

 <h4>validate-widget.sh</h4>
 <p>This tool will validate a widget (zipped or not), both by checking that the
  XML is well formed, and the files that have a ds:Reference. It does not check
  that all files in the widget have a ds:Reference.</p>

 <h4>repack-widget.sh</h4>
 <p>If you make a change to a widget in a directory this tool will zip it. It
  can also update the digests and signature in the signature file, and verify
  the widget's signatures.</p>

 <h4>create-keys.sh add </h4>
 <p>This tool can regenerate many of the keys needed for this test suite, however
  it is more useful for adding additional keys to the testCA by running
  <code>create-keys.sh add</code>. When provided with a command to generate the
  key (for example with OpenSSL) it will create a certificate and p12 file.</p>

 <h3>Keys and certificates</h3>
 <p>For this test suite a test certificate authority called "testCA" has been created. The
  commands used to create the certificates are available in
  <a href="tools/">tools/create-keys.sh</a> and the resulting files
  are in the <a href="keys/">keys/</a> directory. The password for all of the
  p12 files is "secret".</p>

 <p>The following two certificates are used
 to test that implementations can perform basic path validation, but are not used to sign any widgets:</p>

 <dl>
  <dt>Root (<a href="keys/root.key.pem">key</a>,
   <a href="keys/root.cert.pem">cert</a>,
   <a href="keys/root.p12">p12</a>)
  </dt>
  <dd>This is the root certificate for the CA, and needs to be trusted for this test suite.</dd>

  <dt>Second key/cert (<a href="keys/2.rsa.key.pem">key</a>,
   <a href="keys/2.rsa.cert.pem">cert</a>,
   <a href="keys/2.rsa.p12">p12</a>)
  </dt>
  <dd>This certificate is signed by the root certificate, and should be added
  as an untrusted certificate for this test suite.</dd>
 </dl>

 <p>The following keys and certificates are used to sign widgets:</p>

 <dl>
  <dt>RSA 2048 (<a href="keys/3.rsa.key.pem">key</a>,
   <a href="keys/3.rsa.cert.pem">cert</a>,
   <a href="keys/3.rsa.p12">p12</a>)
  </dt>
  <dd>Unless otherwise mentioned, this key should be used to sign/validate the test suite widgets.</dd>

  <dt>DSA 2048 (<a href="keys/3.dsa.key.pem">key</a>,
   <a href="keys/3.dsa.cert.pem">cert</a>,
   <a href="keys/3.dsa.p12">p12</a>)
  </dt>

  <dt>ECDSA (<a href="keys/ecdsa.key.pem">key</a>,
   <a href="keys/ecdsa.cert.pem">cert</a>,
   <a href="keys/ecdsa.p12">p12</a>)
  </dt>

  <dt>RSA 512 (<a href="keys/512.rsa.key.pem">key</a>,
   <a href="keys/512.rsa.cert.pem">cert</a>,
   <a href="keys/512.rsa.p12">p12</a>)
  </dt>

  <dt>RSA 2048, revoked (<a href="keys/revoked.rsa.key.pem">key</a>,
   <a href="keys/revoked.rsa.cert.pem">cert</a>,
   <a href="keys/revoked.rsa.p12">p12</a>,
   <a href="keys/testCA/crl/revoked.crl">CRL</a>)
  </dt>
 </dl>

<h2>How to get the tests and test descriptions</h2>
<p><strong>Before you run the tests, please make sure you read this document thoroughly.</strong></p>
<p>Tests can be downloaded using CVS using the following commands:</p>
<pre>CVSROOT=:pserver:anonymous@dev.w3.org:/sources/public cvs login
</pre>

<p>Then enter the password <kbd>anonymous</kbd> when prompted, and then: </p>
<pre>
CVSROOT=:pserver:anonymous@dev.w3.org:/sources/public cvs checkout 2006/waf/widgets/test-suite/
</pre>
<p>The Working Group also
  provides an <a href="test-suite.xml">XML file</a> that describes each test case, links to each test
  case, and identifies the assertion being tested.</p>

<h2 id="testedAssertions">Tested assertions</h2>

 <div id="tests"></div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript" src="../../widgets-shared/javascript/ShowTestSuite.js"></script>
<p>The following assertions are not tested, because they are untestable:</p>
<blockquote><p>A <a class="product-signer" href="#signer">signer</a> <em
    class="ct">MUST</em> place a unique identifier string for the signature
in the <code>dsp:Identifier</code> signature property. This <em
    class="ct">MUST</em> be a unique signing string for all <a
    href="#widget-signature" title="widget signature">widget signatures</a> created by the signer.</p></blockquote>
</body>

</html>
