<!-- Imported and adapted from Webkit; 29 Sep 2009; path: webkit/LayoutTests/http/tests/appcache/test-disabled.html -->
<!-- Test to ensure the the window.applicationCache attribute is defined but non-functional with the feature disabled. Should say PASS -->

<html>
<head>
   <title>Test to ensure the the window.applicationCache attribute is defined but non-functional with the feature disabled.</title>
</head>

<body>
<p>Test to ensure the the window.applicationCache attribute is defined but non-functional with the feature disabled. Should say 'PASS'</p>
<div id="result"></div>

<script>
var verifyTest = window.opener.verifyTest;

function log(result, message)
{ 
   if (result == "PASS")
      { 
       document.getElementById('result').innerHTML += result; 
       verifyTest(window, true, message);
      }
   else
      {
       document.getElementById('result').innerHTML += ": " + message + "<br>";
       verifyTest(window, false, message);
      }
}

function isDefined()
{
   if (window.applicationCache)  { return true; }
   else                          { return false; }
}

function statusIsUncached()
{ return applicationCache.status == 0; }

function swapThrows()
{
   try
      {
       applicationCache.swapCache();
       return false;
      } 
   catch(e)
      { return true; }
}

function updateThrows()
{
   try
      {
       applicationCache.swapCache();
       return false;
      }
   catch(e)
      { return true; }
}

if (isDefined() && statusIsUncached() && swapThrows() && updateThrows())
   { log("PASS", ""); }
else
   { 
    if      (isDefined() == false)         { log("FAIL", "ApplicationCache is not defined"); }
    else if (statusIsUncached() == false)  { log("FAIL", "Status is uncached"); }
    else if (swapThrows() == false)        { log("FAIL", "ApplicationCache swapCache method throws an exception"); }
    else if (udateThrows() == false)       { log("FAIL", "ApplicationCache updateCache method throws an exception"); }
    else                                   { log("FAIL", "An ambiguous error occurred"); }
   }
</script>
</body>
</html>

