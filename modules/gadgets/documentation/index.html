<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en" dir="ltr">
<head>
 <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
 <title>Gadgets module</title>
 <meta content="Lasse Magnussen" name="author">
 <link rel="stylesheet" href="../../coredoc/coredoc.css" type="text/css" media="all">
 <link rel="contents" href="../../coredoc/index.html" type="text/html" title="Core API">
 <style type="text/css">
  a[href^="http://"]:after { content: " (external link)"; }
  a[href^="https://"]:after { content: " (external link)"; }
  a[href^="http://wiki.oslo.opera.com"]:after { content: ""; }
  a[href^="https://cgit.oslo.osa"]:after { content: ""; }
  ul#tocUl { list-style: none; padding-left: 0; }
 </style>
 <script type="text/javascript" src="../../coredoc/createtoc.js"></script>
</head>
<body>
 <h1>Gadgets module</h1>
 <p id="toc">
  Copyright © 2005-2012 Opera Software ASA. All rights reserved.
  This file is part of the Opera web browser. It may not be distributed
  under any circumstances.
 </p>

 <h2 id="intro">Introduction</h2>
 <p>
  The gadgets module implement management of Web Widgets.
  It is called gadgets simply because the name widgets was already taken,
  and in its documentation the words “widgets” and “gadgets” are used
  interchangibly.
  All user-visible and customer-visible documentation should document it
  as “widgets”.
 </p>
 <p>
  The gadgets module currently support regular widgets (both the old Opera
  widgets and the W3C Widgets 1.0 specification), and, if enabled by the
  <a href="../../hardcore/documentation/features.html">feature system</a>,
  <a href="../../webserver/documentation/index.html">Unite applications</a>
  and Opera Extensions.
 </p>
 <p>
  Please note that the implementation of most of the APIs accessible
  <em>to</em> Widgets are implemented elsewhere, for example in the
  <a href="../../dom/documentation/index.html">DOM module</a>.
 </p>

 <h2 id="api">
  Interface overview and
  <abbr title="Application programming interface">API</abbr>
  documentation
 </h2>
 <p>
  For detailed information on how to use the gadgets module in Opera and
  the module's public API, please refer to the

    <a href="api/index.html">API documentation</a>.

  The documentation needs to be generated by Doxygen.
 </p>
 <p>
  The visible API consists largely of the following classes:
 </p>
 <dl>
  <dt><a href="api/classOpGadgetManager.html">OpGadgetManager</a></dt>
   <dd>
    <p>
     Responsible for the over-all managing of active and inactive widgets.
     It maintains a list of all OpGadget instances (be they Widgets,
     Unite Applications or Opera Extensions), as well as a list of all
     OpGadgetClass instances.
     Its API consists mainly of managerial functionality, like creating,
     destroying, enumerating and querying widgets, as well as some utility
     functionality used by the other classes in the widget, and which need
     access to state information.
    </p>
   </dd>

  <dt><a href="api/classOpGadget.html">OpGadget</a></dt>
   <dd>
    <p>
     Representation of a single instance of a widget.
     Responsible for holding state information about the widget instance.
     Its API contains of interface functions used to connect the information
     about the widget to the DOM interface and other parts of the code.
     It also has several APIs that proxy information from the OpGadgetClass
     instance; each OpGadget has a pointer to an OpGadgetClass instance.
    </p>
   </dd>
  
  <dt><a href="api/classOpGadgetClass.html">OpGadgetClass</a></dt>
   <dd>
    <p>
     Representation of an installed widget.
     Responsible for parsing its configuration and hold its configuration
     information.
     The OpGadgetClass API has access to the information about the widget's
     configuration and installed files, most of which are proxied through
     the OpGadget class, so it does not need to be accessed directly that
     often.
    </p>
   </dd>

  <dt>Gadget update classes
   <dd>
    <p>
     TODO:
     Document
     <a href="api/classOpGadgetUpdateObject.html">OpGadgetUpdateObject</a>,
     <a href="api/classOpGadgetDownloadObject.html">OpGadgetDownloadObject</a>,
     <a href="api/classOpGadgetDownloadCallbackToken.html">OpGadgetDownloadCallbackToken</a>,
     and
     <a href="api/classOpGadgetUpdateInfo.html">OpGadgetUpdateInfo</a>.
    </p>
   </dd>
  <dt><a href="api/classOpGadgetInstallObject.html">OpGadgetInstallObject</a></dt>
   <dd>
    <p>
     Represents a temporary widget which can be installed later on.
	 The installer can be filled with data incrementally by appending bytes to it.
	 This is quite useful if you need to transfer widget data from remote and
	 need to transfer only a certain amount of data at a time.
	 Note: Only available if API_GADGET_INSTALLER is imported.
    </p>
   </dd>
  <dt>Utility classes
   <dd>
    In addition to these, there are some utility classes:
    <a href="api/classOperaWidgets.html">OperaWidgets</a> generates the
    opera:widgets and opera:extensions documents (Widget Manager and Extensions
    Manager),
    <a href="api/classOperaUnite.html">OperaUnite</a> generates the opera:unite
    document (Unite Application Manager),
    and
    <a href="api/classGadgetsModule.html">GadgetsModule</a> contains
    initialization and termination support.
   </dd>
 </dl>

 <h2 id="usecases">Use-cases</h2>
 <h3 id="usecases-installing">Installing a widget</h3>
 <p>
  To install a widget, parsing its configuration file and returning an
  <a href="api/classOpGadget.html">OpGadget</a> instance to be used, the
  <a href="api/classOpGadgetManager.html">OpGadgetManager</a> class provides
  <code>CreateGadget()</code>.
  The gadget retrieved through this interface will be added to the list of
  gadgets managed by OpGadgetManager.
 </p>
 <p>
  This does <em>not</em> copy any files, this has to be done by the caller.
 </p>

 <h3 id="usecases-displaying">Displaying a widget</h3>
 <p>
  The <a href="api/classOpGadgetManager.html">OpGadgetManager</a> class
  provides <code>OpenGadget()</code> in several variations, which can be used
  to display a widget.
 </p>
 <p>
  If you provide it with a path to a gadget, an
  <a href="api/classOpGadget.html">OpGadget</a> instance will be created
  and opened.
  If provided with an OpGadget instance, it will cause this to be displayed.
 </p>

 <h3 id="usecases-uninstalling">Uninstalling a widget</h3>
 <p>
  The <a href="api/classOpGadgetManager.html">OpGadgetManager</a> class
  provides <code>RemoveGadget()</code>, which removes the widget and its
  related data from disk.
 </p>

 <h2 id="standards">Supported standards</h2>
 <p>
  Please note that the gadgets module implements the packaging, installation
  and upgrading related parts of the specifications below.
  The specifications also define specific DOM interfaces.
  These interfaces are implemented by the
  <a href="../../dom/documentation/index.html">dom module</a>.
 </p>

 <h3 id="w3c-standards">W3C published standards</h3>
 <p>
  <i>TODO-document the extent of support</i>
  <i>TODO-document all standards supported</i>
 </p>
 <ul>
  <li><a href="http://dev.w3.org/2006/waf/widgets/">Widgets 1.0: Packaging and Configuration</a></li>
  <li><a href="http://dev.w3.org/2006/waf/widgets-api/">Widgets 1.0: APIs and Events</a></li>
  <li><a href="http://dev.w3.org/2006/waf/widgets-digsig/">Widgets 1.0: Digital Signatures</a></li>
 </ul>

 <h3 id="opera-standards">Opera published standards</h3>
 <p>
  <i>TODO-document the extent of support</i>
  <i>TODO-document all standards supported</i>
 </p>
 <ul>
  <li><a href="http://dev.opera.com/articles/view/opera-widgets-specification-1-0-third-ed-2/">Opera Widgets Specification 1.0 third edition</a></li>
  <li><a href="http://unite.opera.com/develop/">Opera Unite</a></li>
  <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/extensions/index.html">Opera Extensions</a>
   <ul>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/backgroundProcess/index.html">Opera Extensions: Background Process</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/buttons/index.html">Opera Extensions: Buttons</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/clipboard/index.html">Opera Extensions: Clipboard</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/menus/index.html">Opera Extensions: Menus</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/panels/index.html">Opera Extensions: Panels</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/scope/index.html">Opera Extensions: Scope</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/tabs/index.html">Opera Extensions: Tabs</a></li>
    <li><a href="https://cgit.oslo.osa/cgi-bin/cgit.cgi/core/extapps-docs.git/plain/extensions/specs/userContent/index.html">Opera Extensions: User Content</a></li>
   </ul>
  </li>
 </ul>

 <h3 id="other-standards">Other published standards</h3>
 <p>
  <i>TODO-document all standards supported</i>
 </p>

 <h2 id="implementationanddesign">Implementation and design</h2>
 <h3 id="designprinciples">Design principles</h3>

 <h3 id="initialisation">Initialisation</h3>
 <p>
  The initialisation of the module is handled through the
  <code>Opera::InitL()</code> API.
 </p>

 <h3 id="memorymanagement">Memory management</h3>
 <h4 id="memorymanagement-stack">Stack usage</h4>
 <h4 id="memorymanagement-static">Static memory usage</h4>
 <p>
  There is one global instance of the
  <a href="api/classOpGadgetManager.html">OpGadgetManager</a>
  class, which is created when
  <code>GadgetsModule::InitL()</code>
  is called and destroyed in
  <code>GadgetsModule::Destroy()</code>.
 </p>

 <h4 id="memorymanagement-oom"><abbr title="Out of memory">OOM</abbr>
  policies</h4>
 <p>
  Most functions detect out-of-memory errors and return them to the caller,
  making it up to the caller to make any necessary measures for such
  problems.
 </p>

 <h3 id="performance">Performance</h3>
 <p>
  The OpGadgetManager does enumerate all installed widgets on start-up,
  which can cause delays if many widgets are installed, especially if the
  file system is slow.
 </p>

 <h2 id="seealso">See also</h2>

 <h2 id="references">References</h2>

</body>
</html>
