<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>The ZLib module</title>
</head>
<link rel=stylesheet href="../../coredoc/coredoc.css" />
<body>

<h1>The ZLib module</h1>

<h2>introduction</h2>
<p>
<a href="http://www.zlib.net">ZLib</a> is an abstraction of the <a
href="http://www.gzip.org/zlib/rfc-deflate.html">DEFLATE</a>
compression algorithm. It can (losslessly) compress and decompress
data. DEFLATE uses a combination of the LZ77 sliding window and
Huffmann coding to achieve compression.
</p>
<p>
ZLib is a third party module, and as such, the finer details of the
zlib implementation are sometimes not known. Thus, the documentation
of the zlib module is at times sparse.
</p>

<h3>Supported formats</h3>

<p>
ZLib can compress data to and extract data from the zlib
format. This format is somewhat a <emph>de facto</emph> standard.
</p>

<h2>API Documentation</h2>
<p>
The <a href="api/index.html">API Documentation</a> is generated by Doxygen.
</p>

<h2>Memory usage</h2>

<h3>Deflation (compression)</h3>
<p>
Taken from zconf.h:
</p>
<p>
The memory requirements for deflate are (in bytes):<br>
(1 &lt;&lt; (windowBits+2)) + (1 &lt;&lt; (memLevel+9))<br>
that is: 128K for windowBits=15 + 128K for memLevel = 8 (default
values) plus a few kilobytes for small objects.
</p>

<h3>Inflation (decompression)</h3>
<p>
Taken from zconf.h:
</p>
<p>
The memory requirements for inflate are (in bytes):<br>
1 &lt;&lt; windowBits<br>
that is, 32K for windowBits=15 (default value) plus a few kilobytes
for small objects.
</p>

<h3>Stack</h3>
<p>
ZLib has a load of <code>static const int</code> data on the
stack. Most of it is static huffmann trees, lengths and distances.
</p>

<h3>Globals</h3>
<p>
ZLib has three OperaGlobals, <code>m_static_l_desc</code>,
<code>m_static_d_desc</code> and <code>m_static_bl_desc</code>. All
have the type <code>static_tree_desc_s</code>.
</p>

<h3>OOM</h3>

<p>
ZLib functions that may run out of memory will return
<code>Z_MEM_ERROR</code> if an allocation fails. (Notable exception is
<code>updatewindow</code>, that returns 1. However, ZLib functions
that call <code>updatewindow</code> will still return
<code>Z_MEM_ERROR</code> if this happens.)  Handling OOM is left to
caller.
</p>

<h2>Implementation</h2>

Both inflation and deflation is performed by first creating and
initializing a z_streamp stream, and then call deflate/inflate until
all data is processed. The caller is responsible for filling the input
buffer with data and make sure there's room in the output buffer
before each call. Both deflate and inflate will process as much data
as possible, not stopping until the input buffer is empty or the
output buffer is full.

</body>
</html>
