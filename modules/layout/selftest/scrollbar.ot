/* -*- mode: c++; tab-width: 4; c-basic-offset: 4 -*- */

group "layout.scrollbar";

require init;

include "modules/doc/frm_doc.h";
include "modules/dochand/win.h";
include "modules/layout/box/box.h";
include "modules/layout/content/content.h";
include "modules/logdoc/htm_elm.h";
include "modules/pi/OpWindow.h";

language ecmascript;

/* Simple content overflowing it's parent */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto;">
//!       <div id="inner" style="width: 200px; height: 200px; "></div>
//!     </div>
//!   </body>
//! </html>
}

test("Child overflows parent with auto scrollbars")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Descendant overflow causes scrollbars up in his non-direct ancestor */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto;">
//!       <div style="width: 50px; height: 50px; overflow:visible">
//!         <div id="inner" style="width: 200px; height: 200px; "></div>
//!       </div>
//!     </div>
//!   </body>
//! </html>
}

test("Child overflows ancestor with auto scrollbars")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Descendant overflow clipped - no overflow in outer div */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto;">
//!       <div style="width: 50px; height: 50px; overflow:hidden">
//!         <div id="inner" style="width: 200px; height: 200px; "></div>
//!       </div>
//!     </div>
//!   </body>
//! </html>
}

test("Descendant overflow clipped and not propagated up")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Overflow generated by multiple boxes with margins */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto;">
//!       <div style="width: 10px; height: 98px; border: 1px solid black;"></div>
//!       <div style="width: 88px; height: 88px; border: 1px solid black; margin-left:10px; margin-top:10px;"></div>
//!     </div>
//!   </body>
//! </html>
}

test("Overflow produced by multiple blocks with margins")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Descendant clipped overflow combined with normal overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto;">
//!       <div style="width: 50px; height: 50px; overflow:hidden">
//!         <div style="width: 200px; height: 200px; "></div>
//!       </div>
//!       <div style="width: 200px; height: 150px; "></div>
//!     </div>
//!   </body>
//! </html>
}

test("Clipped descendant overflow combined with sibling overflow")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Descendant overflow combined with normal overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto;">
//!       <div style="width: 50px; height: 50px; overflow:visible">
//!         <div style="width: 300px; height: 300px; "></div>
//!       </div>
//!       <div style="width: 200px; height: 150px; "></div>
//!     </div>
//!   </body>
//! </html>
}

test("Descendant overflow combined with siblings")
{
    verify(document.getElementById('outer').scrollWidth == 300);
    verify(document.getElementById('outer').scrollHeight == 300);
}

/* Line overflows container */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; white-space: nowrap; overflow: auto;">
//!        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut ullamcorper, arcu ac dictum feugiat, leo lectus tincidunt nisl,
//!        vitae lobortis arcu tortor id turpis. Mauris nec turpis eros, a placerat diam. Mauris diam turpis, scelerisque in tincidunt quis,
//!        consequat sit amet mi. In pellentesque, magna ac ultricies interdum, est ipsum pellentesque nunc, id mattis risus est eu tortor.
//!        Etiam at sem non justo tincidunt accumsan. Nulla facilisi. Quisque ut libero in orci imperdiet ultrices in in eros.
//!        Vestibulum eu eros rutrum magna tincidunt faucibus. Aliquam eget nunc et justo luctus faucibus in id metus.
//!        Sed neque nunc, vestibulum eu convallis et, lobortis sit amet nisl. Donec arcu arcu, aliquam non condimentum nec, fermentum et neque.
//!     </div>
//!   </body>
//! </html>
}

test("Simple text overflow")
{
    verify(document.getElementById('outer').scrollWidth > 0);
    verify(document.getElementById('outer').scrollHeight > 0);
}

/* Line with replaced inline overflows container */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; white-space: nowrap; overflow: auto; line-height: 1px;">
//!     <img style="width: 75px; height 75px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC"><img style="width: 75px; height 75px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC"><br>
//!     <img style="width: 75px; height 75px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!     </div>
//!   </body>
//! </html>
}

test("Replaced inline overflows container")
{
    verify(document.getElementById('outer').scrollWidth == 150);
    verify(document.getElementById('outer').scrollHeight == 150);
}

/* Line with overflowing inline-block */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; white-space: nowrap; overflow: auto; line-height: 1px;">
//!        <div style="display:inline-block; width: 200px; height: 200px"></div>
//!     </div>
//!   </body>
//! </html>
}

test("Inline-block overflows it's container")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Inline block content overflows inline-block's container */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; white-space: nowrap; overflow: auto; line-height: 1px;">
//!        <div style="display:inline-block; width: 50px; height: 50px; overflow:visible; line-height: 1px;">
//!            <img style="width: 200px; height 200px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Inline-block's content overflows parent container")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Auto height inline block content overflows inline-block's container */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; white-space: nowrap; overflow: auto; line-height: 1px;">
//!        <div style="display:inline-block; width: 50px; overflow:visible; line-height: 1px;">
//!            <img style="width: 200px; height 200px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Auto height inline-block's content overflows parent container")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Auto height inline block content overflows inline-block's container */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; white-space: nowrap; overflow: auto; line-height: 70px;">
//!        <div style="display:inline-block; width: 50px; height:70px; overflow:visible; line-height: 1px;">
//!            <img style="width: 70px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Inline-block's hidden overflow - no scrollbars")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Top aligned inline block without overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 100px;">
//!        <div style="display:inline-block; width: 50px; height:50px; line-height: 1px; overflow:visible; vertical-align: top;">
//!            <img style="width: 100px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Top aligned inline-block without overflow")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Top aligned inline block with overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 100px;">
//!        <div style="display:inline-block; width: 50px; height:50px; line-height: 1px; overflow:visible; vertical-align: top;">
//!            <img style="width: 100px; height: 110px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Top aligned inline-block with overflow")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 110);
}

/* Baseline aligned inline block without overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 100px;">
//!        <div style="display:inline-block; width: 50px; height:50px; overflow:visible;">
//!            <img style="width: 55px; height 55px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Baseline aligned inline-block without overflow")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Baseline aligned inline block with overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 100px;">
//!        <div style="display:inline-block; width: 50px; height:50px; overflow:visible;">
//!            <img style="width: 100px; height: 60px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Baseline aligned inline-block with overflow")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight > 100);
}

/* Bottom aligned inline block without overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 80px;">
//!        <div style="display:inline-block; width: 10px; height:10px; overflow:visible; vertical-align:bottom; line-height: 1px;">
//!            <img style="width: 20px; height 20px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Bottom aligned inline-block without overflow")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Bottom aligned inline block with overflow */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 80px;">
//!        <div style="display:inline-block; width: 10px; height:10px; overflow:visible; vertical-align:bottom; line-height: 1px;">
//!            <img style="width: 40px; height: 40px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Bottom aligned inline-block with overflow")
{
    verify(document.getElementById('outer').scrollWidth <= 100);
    verify(document.getElementById('outer').scrollHeight > 100);
}

/* Margins and paddings - baseline aligned */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 1px;">
//!        <div style="display:inline-block; width: 50px; height: 50px; overflow:visible; line-height: 1px; padding: 10px;">
//!            <img style="margin: 10px; width: 100px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Baseline aligned inline-block with margins/paddings overflow")
{
    verify(document.getElementById('outer').scrollWidth == 130);
    verify(document.getElementById('outer').scrollHeight == 130);
}

/* Margins and paddings - top aligned */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 1px;">
//!        <div style="display:inline-block; width: 50px; height: 50px; overflow:visible; line-height: 1px; padding: 10px; vertical-align:top;">
//!            <img style="margin: 10px; width: 100px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Top aligned inline-block with margins/paddings overflow")
{
    verify(document.getElementById('outer').scrollWidth == 130);
    verify(document.getElementById('outer').scrollHeight == 130);
}

/* Margins and paddings - bottom aligned */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; line-height: 100px;">
//!        <div style="display:inline-block; width: 50px; height: 50px; overflow:visible; line-height: 1px; padding: 10px; vertical-align:bottom;">
//!            <img style="margin: 10px; width: 100px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Bottom aligned inline-block with margins/paddings overflow")
{
    verify(document.getElementById('outer').scrollWidth == 130);
    verify(document.getElementById('outer').scrollHeight == 160);
}

/* Simple overflowing text */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; font-size: 40px; border: 1px solid black;">
//!        Lorem ipsum dolor sit amet
//!     </div>
//!   </body>
//! </html>
}

test("Simple text overflow")
{
    verify(document.getElementById('outer').scrollWidth > 100);
    verify(document.getElementById('outer').scrollHeight > 100);
}


/* Text preceding overflowing inline block */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; font-size: 40px; border: 1px solid black; white-space:nowrap;">
//!        L
//!        <div style="display:inline-block; width: 50px; height: 10px; overflow:visible; line-height: 1px;">
//!            <img style="vertical-align: bottom; width: 55px; height 55px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Text before overflowing content - no scrollbars")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Text preceding overflowing inline block */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!     <div id="outer" style="height: 100px; width: 100px; overflow: auto; font-size: 40px; border: 1px solid black; white-space:nowrap;">
//!        L
//!        <div style="display:inline-block; width: 50px; height: 10px; overflow:visible; line-height: 1px;">
//!            <img style="vertical-align: bottom; width: 100px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!     </div>
//!   </body>
//! </html>
}

test("Text before overflowing content - scrollbars")
{
    verify(document.getElementById('outer').scrollWidth > 100);
    verify(document.getElementById('outer').scrollHeight > 100);
}

/* Text after overflowing inline block */

html
{
//! <!doctype html>
//! <html>
//!   <body>
//!    <div id="outer" style="height: 100px; width: 100px; overflow: auto; font-size: 40px; border: 1px solid black; white-space:nowrap;">
//!        <div style="display:inline-block; width: 50px; height: 10px; overflow:visible; line-height: 1px; vertical-align: bottom;">
//!            <img style="vertical-align: bottom; width: 100px; height 100px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oLBQ4eLaR/GmoAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAADElEQVQI12NgYFgOAACrAKj7nKxeAAAAAElFTkSuQmCC">
//!        </div>
//!        L
//!     </div>
//!   </body>
//! </html>
}

test("Text after overflowing content - scrollbars")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight > 100);
}

/* Right aligned overflowing inline block */

html
{
//! <!doctype html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; width: 200px; height: 200px; border: 1px solid lime; overflow:auto; text-align:right; ">
//!    <div style="display:inline-block; width: 100px; height: 1em;">
//!     <div style="width: 200px; height: 100px; background-color:navy"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Right aligned, overflowing inline block")
{
    verify(document.getElementById('outer').scrollWidth == 300);
    verify(document.getElementById('outer').scrollHeight <= 200);
}


/* Absolutely positioned child */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div id="testme" style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #1")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Absolutely positioned child - scrollable container between containing block and abs positioned element - no scrollbars*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div style="position:relative;">
//!    <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!     <div>X
//!      <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!     </div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #2")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Absolutely positioned child - scrollable container between containing block and abs positioned element - no scrollbars
   There is an empty element between abspos element and it's container */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div style="position:relative;">
//!    <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!     <div>
//!      <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!     </div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #3")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Absolutely positioned child - non-empty containing block with visible overflow insinde scrollable container - scrollbars*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="position:relative;">X
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #4")
{
    verify(document.getElementById('outer').scrollWidth == 410);
    verify(document.getElementById('outer').scrollHeight == 410);
}

/* Absolutely positioned child - empty containing block with visible overflow insinde scrollable container - scrollbars*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="position:relative;">
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #5")
{
    verify(document.getElementById('outer').scrollWidth == 410);
    verify(document.getElementById('outer').scrollHeight == 410);
}

/* Absolutely positioned child - empty containing block with visible overflow insinde scrollable container - scrollbars*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="position:relative;">
//!     <div style="background-color: lime; width: 300px; height: 10px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #6")
{
    verify(document.getElementById('outer').scrollWidth == 300);
}

/* Absolutely positioned child - non-empty containing block with hidden overflow insinde scrollable container - no scrollbars*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="position:relative; overflow:hidden;">X
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #7")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Absolutely positioned child - empty containing block with hidden overflow insinde scrollable container - no scrollbars*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="position:relative; overflow:hidden;">
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #8")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Absolutely positioned box inside inline-block box with visible overflow - no scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div style="display:inline-block;">
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #9")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 200);
}

/* Absolutely positioned box inside positioned inline-block box with visible overflow - scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div style="display:inline-block; position:relative;">
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #10")
{
    verify(document.getElementById('outer').scrollWidth == 410);
    verify(document.getElementById('outer').scrollHeight == 426);
}

/* Absolutely positioned box inside inline-block box - overflow propagated up to containing element - scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div style="position:relative; text-indent: 10px;">
//!     <div style="display:inline-block;">
//!      <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!     </div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #11")
{
    verify(document.getElementById('outer').scrollWidth >= 410);
    verify(document.getElementById('outer').scrollHeight >= 410);
}


/* Tests how bounding boxes from inline boxes are propagated up- scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; height: 250px; width: 250px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div id="inner" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!     <div style="display:inline-block;">
//!      <div id="testme" style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!     </div>
//!     <div style="width: 250px; height: 250px; background-color:pink;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #12")
{
    verify(document.getElementById('inner').scrollWidth == 250);
    verify(document.getElementById('inner').scrollHeight == 270);
    verify(document.getElementById('outer').scrollWidth >= 410);
    verify(document.getElementById('outer').scrollHeight >= 410);
}

/* Tests how bounding boxes from inline boxes are propagated up- scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; height: 250px; width: 250px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div id="inner" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!     <div style="display:inline;">
//!      <div id="testme" style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!     </div>
//!     <div style="width: 250px; height: 250px; background-color:pink;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #13")
{
    verify(document.getElementById('inner').scrollWidth == 250);
    verify(document.getElementById('inner').scrollHeight == 250);
    verify(document.getElementById('outer').scrollWidth == 410);
    verify(document.getElementById('outer').scrollHeight == 410);
}

/* Tests how bounding boxes from inline boxes are propagated up- scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; height: 250px; width: 250px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div id="inner" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!     <div>
//!      <div id="testme" style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!     </div>
//!     <div style="width: 250px; height: 250px; background-color:pink;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #14")
{
    verify(document.getElementById('inner').scrollWidth == 250);
    verify(document.getElementById('inner').scrollHeight == 250);
    verify(document.getElementById('outer').scrollWidth == 410);
    verify(document.getElementById('outer').scrollHeight == 410);
}

/* Tests if content box is correctly propagated through non positioned elements */

html
{
//! <!DOCTYPE html>
//! <html>
//! <body>
//!  <div id="outer" style="width: 100px; height: 100px; border: 1px solid lime; overflow:auto">
//!   <div style="position:relative;">
//!    <div style="width: 50px; height: 50px;">
//!     <div style="position: absolute; background-color:pink; width: 200px; height: 75px;"></div>
//!     <div style="position: absolute; background-color:pink; width: 200px; height: 75px; top: 75px;"></div>
//!    </div>
//!   </div>
//!  </div>
//! </body>
//! </html>
}

test("Absolutely positioned child #15")
{
    verify(document.getElementById('outer').scrollWidth == 200);
    verify(document.getElementById('outer').scrollHeight == 150);
}

/* abspos box ancestor should not modify it's bounding box */

html
{
//! <!DOCTYPE html>
//! <html>
//! <body>
//!  <div id="outer" style="overflow:auto; position:relative; width: 200px; height: 200px; border: 1px solid lime;">
//!   <div style="width: 100px; height: 100px; border: 1px solid pink; overflow: hidden;">
//!    <div style=" width: 400px; height: 100px; background-color: navy;">
//!     <div style="position:absolute; width: 10px; height: 10px; background-color: green; top: 300px;"></div>
//!    </div>
//!   </div>
//!  </div>
//! <body>
//! </html>
}

test("Absolutely positioned child #16")
{
    verify(document.getElementById('outer').scrollWidth < 200);
    verify(document.getElementById('outer').scrollHeight == 310);
}

/* abspos box ancestor should not modify it's bounding box */

html
{
//! <!DOCTYPE html>
//! <html>
//! <body>
//!  <div id="outer" style="overflow:auto; position:relative; width: 200px; height: 200px; border: 1px solid lime;">
//!   <div style="display:inline-block; width: 100px; height: 100px; border: 1px solid pink; overflow: hidden;">
//!    <div style=" width: 400px; height: 100px; background-color: navy;">
//!     <div style="position:absolute; width: 10px; height: 10px; background-color: green; top: 300px;"></div>
//!    </div>
//!   </div>
//!  </div>
//! <body>
//! </html>
}

test("Absolutely positioned child #17")
{
    verify(document.getElementById('outer').scrollWidth <= 200);
    verify(document.getElementById('outer').scrollHeight >= 310);
}

/* Right aligned overflowing inline block with absolutely positioned child */

html
{
//! <!doctype html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; width: 200px; height: 200px; border: 1px solid lime; overflow:auto; text-align:right; ">
//!    <div style="display:inline-block; width: 100px; height: 1em;">
//!     <div style="position:absolute; width: 200px; height: 100px; background-color:navy"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #18")
{
    verify(document.getElementById('outer').scrollWidth == 300);
    verify(document.getElementById('outer').scrollHeight <= 200);
}

/* Overflow should not be propagated past containing element with hidden overflow */

html
{
//! <!doctype html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; overflow:auto; width:100px; height:100px;">
//!    <div style="position:relative; overflow:hidden; width:100px; height:100px;">
//!     <div style="position:absolute; top:300px; left:300px; width:100px; height:100px; background-color: lime;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #19")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Overflow should be propagated past containing element with visible overflow */

html
{
//! <!doctype html>
//! <html>
//!  <body>
//!   <div id="outer" style="position:relative; overflow:auto; width:100px; height:100px;">
//!    <div style="position:relative; width:100px; height:100px;">
//!     <div style="position:absolute; top:300px; left:300px; width:100px; height:100px; background-color: lime;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #20")
{
    verify(document.getElementById('outer').scrollWidth == 400);
    verify(document.getElementById('outer').scrollHeight == 400);
}

/* Abspos generated overflow should not be propagated past empty box */

html
{
//! <!doctype html>
//! <html>
//!  <body>
//!  <div id="outer" style="width: 100px; height: 100px; border: 1px solid pink; overflow: auto;">
//!   <div style="overflow:hidden">
//!    <div style="position:absolute; width: 10px; height: 10px; background-color: green; top: 300px;"></div>
//!   </div>
//!  </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #21")
{
    verify(document.getElementById('outer').scrollWidth == 100);
    verify(document.getElementById('outer').scrollHeight == 100);
}

/* Abspos descendant of regular block element with hidden overflow */

html
{
//! <!doctype html>
//! <html>
//!  <body style="margin:0">
//!  <div id="outer" style="width: 100px; height: 100px; overflow: hidden;">
//!   <div style="position:absolute; width: 2000px; height: 2000px; background-color: green;"></div>
//!  </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #22")
{
    verify(document.documentElement.scrollWidth == 2000);
    verify(document.documentElement.scrollHeight == 2000);
}

/* Abspos descendant of regular block element with hidden overflow */

html
{
//! <!doctype html>
//! <html>
//!  <body style="margin:0">
//!   <div style="width: 50px; height: 50px; overflow:hidden;">
//!    <div style="position:relative; width: 100px; height: 100px; overflow: hidden;">
//!     <div style="position:absolute; left: 2000px; top: 2000px; width: 2000px; height: 2000px; background-color: green;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #23")
{
    verify(document.documentElement.scrollWidth <= window.innerWidth);
    verify(document.documentElement.scrollHeight <= window.innerHeight);
}

/* Abspos descendant bbox clipped by overflow:hidden ancestors */

html
{
//! <!doctype html>
//! <html>
//!  <body style="margin:0">
//!   <div style="width: 200px; height: 200px; overflow:hidden;">
//!    <div style="position:relative; width: 150px; height: 150px; overflow: hidden;">
//!     <div style="width: 10px; height: 10px; overflow:visible;">
//!      <div style="position:absolute; left: 2000px; top: 2000px; width: 2000px; height: 2000px; background-color: green;"></div>
//!     </div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Absolutely positioned child #24")
{
    verify(document.documentElement.scrollWidth <= window.innerWidth);
    verify(document.documentElement.scrollHeight <= window.innerHeight);
}

/* Absolutely positioned box with non-static horizontal offset inside an inline */

html
{
//! <!DOCTYPE html>
//! <html><body>
//! <div id="testme" style="width: 250px; height: 250px; overflow:auto;">
//!  <div style="position:relative; width:200px; height: 200px; text-align:center;">
//!   <span style="display:inline;">
//!    <span style="position:absolute; width: 200px; height: 20px; left: 300px;"></span>
//!   </span>
//!   </div>
//!  </div>
//! </body></html>
}

test("Absolutely positioned child #25")
{
    verify(document.getElementById('testme').scrollWidth == 500);
    verify(document.getElementById('testme').scrollHeight <= 250);
}

/* Absolutely positioned box with non-static horizontal offset inside an inline-block */

html
{
//! <!DOCTYPE html>
//! <html><body>
//! <div id="testme" style="width: 250px; height: 250px; overflow:auto;">
//!  <div style="position:relative; width:200px; height: 200px; text-align:center;">
//!   <span style="display:inline-block;">
//!    <span style="position:absolute; width: 200px; height: 20px; left: 300px;"></span>
//!   </span>
//!   </div>
//!  </div>
//! </body></html>
}

test("Absolutely positioned child #26")
{
    verify(document.getElementById('testme').scrollWidth == 500);
    verify(document.getElementById('testme').scrollHeight <= 250);
}

/* Absolutely positioned box with non-static vertical offset inside an inline */

html
{
//! <!DOCTYPE html>
//! <html><body>
//! <div id="testme" style="width: 250px; height: 250px; overflow:auto;">
//!  <div style="position:relative; width:200px; height: 200px; text-align:center;">
//!   <span style="display:inline;">
//!    <span style="position:absolute; width: 200px; height: 20px; top: 300px;"></span>
//!   </span>
//!   </div>
//!  </div>
//! </body></html>
}

test("Absolutely positioned child #27")
{
    verify(document.getElementById('testme').scrollWidth <= 250);
    verify(document.getElementById('testme').scrollHeight == 320);
}

/* Absolutely positioned box with non-static vertical offset inside an inline-block */

html
{
//! <!DOCTYPE html>
//! <html><body>
//! <div id="testme" style="width: 250px; height: 250px; overflow:auto;">
//!  <div style="position:relative; width:200px; height: 200px; text-align:center;">
//!   <span style="display:inline-block;">
//!    <span style="position:absolute; width: 200px; height: 20px; top: 300px;"></span>
//!   </span>
//!   </div>
//!  </div>
//! </body></html>
}

test("Absolutely positioned child #28")
{
    verify(document.getElementById('testme').scrollWidth <= 250);
    verify(document.getElementById('testme').scrollHeight == 320);
}


/* Test floats bottom propagation */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="float:left; width: 300px; height: 300px; border: 1px solid pink;"></div>
//!   </div>
//!  </body>
//! </html>
}

test("Floating child triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 302);
	verify(document.getElementById('outer').scrollHeight == 302);
}

/* Test positioned floats bottom propagation */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="position:absolute; float:left; width: 300px; height: 300px; border: 1px solid pink;"></div>
//!   </div>
//!  </body>
//! </html>
}

test("Positioned floating child not triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 200);
	verify(document.getElementById('outer').scrollHeight == 200);
}

/* Test table cells triggering scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <head>
//!  <style>
//!   div.trow { display:table-row; }
//!   div.tcell { display:table-cell; }
//!   div.cnt { width: 150px; height: 150px; border: 1px solid pink; }
//!  </style>
//!  </head>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <div style="display:table">
//!     <div class="trow"><div class="tcell"><div class="cnt"></div></div><div class="tcell"><div class="cnt"></div></div></div>
//!     <div class="trow"><div class="tcell"><div class="cnt"></div></div><div class="tcell"><div class="cnt"></div></div></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Table cells triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 304);
	verify(document.getElementById('outer').scrollHeight == 304);
}

/** Fixed layout table with visible overflow */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <head>
//!  <style>
//!   td { overflow: visible; }
//!   div.cnt { width: 150px; height: 50px; border: 1px solid pink; }
//!  </style>
//!  </head>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table style="table-layout:fixed; width: 200px; border-collapse: collapse; ">
//!     <col style="width:100px" />
//!     <col style="width:100px" />
//!     <tr><td><div class="cnt"></div></td><td><div class="cnt"></div></td></tr>
//!     <tr><td><div class="cnt"></div></td><td><div class="cnt"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Fixed layout table with visible overflow")
{
	verify(document.getElementById('outer').scrollWidth == 253);
}

/** Fixed layout table with hidden overflow */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <head>
//!  <style>
//!   td { overflow: hidden; }
//!   div.cnt { width: 150px; height: 50px; border: 1px solid pink; }
//!  </style>
//!  </head>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table style="table-layout:fixed; width: 200px; border-collapse: collapse; ">
//!     <col style="width:100px" />
//!     <col style="width:100px" />
//!     <tr><td><div class="cnt"></div></td><td><div class="cnt"></div></td></tr>
//!     <tr><td><div class="cnt"></div></td><td><div class="cnt"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Fixed layout table with hidden overflow")
{
	verify(document.getElementById('outer').scrollWidth == 200);
}

/** Fixed layout table with positioned contents */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <head>
//!  <style>
//!   td { overflow: visible; }
//!   div.cnt { width: 150px; height: 50px; border: 1px solid pink; position:absolute;}
//!  </style>
//!  </head>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table style="table-layout:fixed; width: 200px; border-collapse: collapse; ">
//!     <col style="width:100px" />
//!     <col style="width:100px" />
//!     <tr><td><div class="cnt"></div></td><td><div class="cnt"></div></td></tr>
//!     <tr><td><div class="cnt"></div></td><td><div class="cnt"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Fixed layout table with absolutely positioned overflow #1")
{
	verify(document.getElementById('outer').scrollWidth == 200);
}

/** Fixed layout table with positioned contents and ancestors with hidden overflow */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <head>
//!  <style>
//!   td { position:relative; }
//!   div.cnt { width: 200px; height: 200px; left: 2000px; top: 2000px; border: 1px solid pink; position:absolute;}
//!  </style>
//!  </head>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:hidden;">
//!    <table style="table-layout:fixed; width: 200px; border-collapse: collapse;">
//!     <col style="width:100px" />
//!     <tr><td><div class="cnt"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Fixed layout table with absolutely positioned overflow #2")
{
	verify(document.documentElement.scrollWidth <= window.innerWidth);
	verify(document.documentElement.scrollHeight <= window.innerHeight);
}

/** Fixed layout table with abspos contents and relative cells*/

html
{
//! <!DOCTYPE html>
//! <html>
//!  <head>
//!  <style>
//!   td { overflow: visible; }
//!   div.cnt { width: 250px; height: 50px; border: 1px solid pink; position:absolute; }
//!  </style>
//!  </head>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table style="table-layout:fixed; width: 200px; border-collapse: collapse; ">
//!     <col style="width:100px" />
//!     <tr><td style="position:relative"><div class="cnt"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Fixed layout table with absolutely positioned overflow #3")
{
	verify(document.getElementById('outer').scrollWidth == 253);
}

/* Table caption triggering scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table>
//!     <caption><div style="width: 300px; height: 50px; border: 1px solid lime;"></div></caption>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Table caption triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 302);
}

/* Absolutely positioned table caption's child */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table>
//!     <caption><div style="position: absolute; width: 300px; height: 50px; border: 1px solid lime;"></div></caption>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Table caption's absolutely positioned overflowing child")
{
	verify(document.getElementById('outer').scrollWidth == 200);
}

/* Positioned table caption's absolutely positioned child */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table>
//!     <caption style="position:relative"><div style="position: absolute; width: 300px; height: 50px; border: 1px solid lime;"></div></caption>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Positioned table caption's absolutely positioned child #1")
{
	verify(document.getElementById('outer').scrollWidth == 302);
}

/* Positioned table and caption's absolutely positioned child */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:hidden;">
//!    <table style="position:relative;">
//!     <caption><div style="width:5px; height: 5px; overflow:hidden;"><div style="position: absolute; left: 2000px; top: 2000px; width: 300px; height: 50px; border: 1px solid lime;"></div></div></caption>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Positioned table and caption's absolutely positioned child #2")
{
	verify(document.documentElement.scrollWidth <= window.innerWidth);
	verify(document.documentElement.scrollHeight <= window.innerHeight);
}

/* Positioned table and absolutely positioned descendant */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table style="position:relative; padding:0">
//!     <tr><td><div style="position: absolute; width: 300px; height: 50px; border: 1px solid lime;"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Positioned table and absolutely positioned descendant")
{
	verify(document.getElementById('outer').scrollWidth == 305);
}

/* Positioned table with hidden overflow and absolutely positioned descendant */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto;">
//!    <table style="position:relative; overflow:hidden;">
//!     <tr><td><div style="position: absolute; width: 300px; height: 50px; border: 1px solid lime;"></div></td></tr>
//!    </table>
//!   </div>
//!  </body>
//! </html>
}

test("Positioned table with hidden overflow and abspos descendant")
{
	verify(document.getElementById('outer').scrollWidth == 200);
}

/* Transformed child triggering scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="border: 1px solid green; overflow: auto; width: 100px; height: 100px;">
//!    <div style="width: 100px; height: 100px; background-color: navy; transform:rotate(45deg);"></div>
//!   </div>
//!  </body>
//! </html>
}

test("Transformed child triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 121);
	verify(document.getElementById('outer').scrollHeight == 121);
}

/* Transformed inline child triggering scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="border: 1px solid green; overflow: auto; width: 100px; height: 100px; ">
//!    <div style="display:inline-block; width: 100px; height: 100px; background-color: navy; transform:rotate(45deg);"></div>
//!   </div>
//!  </body>
//! </html>
}

test("Transformed inline child triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 121);
	verify(document.getElementById('outer').scrollHeight == 121);
}

/* Top aligned transformed inline child triggering scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="border: 1px solid green; overflow: auto; width: 100px; height: 100px; font-size:5px; line-height: 20px;">X
//!    <div style="vertical-align:top; display: inline-block; width: 100px; height: 100px; background-color: navy; transform:rotate(45deg); -moz-transform:rotate(45deg); -webkit-transform:rotate(45deg); "></div>
//!   </div>
//!  </body>
//! </html>
}

test("Top aligned transformed inline child triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 121);
	verify(document.getElementById('outer').scrollHeight == 141);
}

/* Bottom aligned transformed inline child triggering scrollbars */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="border: 1px solid green; overflow: auto; width: 100px; height: 200px; font-size:5px; line-height: 200px;">X
//!    <div style="vertical-align:bottom; display: inline-block; width: 100px; height: 100px; background-color: navy; transform:rotate(45deg); -moz-transform:rotate(45deg); -webkit-transform:rotate(45deg); "></div>
//!   </div>
//!  </body>
//! </html>
}

test("Bottom aligned transformed inline child triggering scrollbars")
{
	verify(document.getElementById('outer').scrollWidth == 121);
	verify(document.getElementById('outer').scrollHeight == 421);
}

/* Transformed inline block with absolutely positioned child */

html
{
//! <!DOCTYPE html>
//! <html>
//!  <body>
//!   <div id="outer" style="height: 200px; width: 200px; border: 1px solid black; overflow:auto; font-family: ahem; font-size: 20px;">
//!    <div style="display:inline-block; width: 100px; height: 100px; background-color: navy; transform:rotate(45deg); -moz-transform:rotate(45deg); -webkit-transform:rotate(45deg);">
//!     <div style="background-color: lime; width: 10px; height: 10px; left: 400px; top: 400px; position: absolute;"></div>
//!    </div>
//!   </div>
//!  </body>
//! </html>
}

test("Transformed inline block with absolutely positioned child")
{
	verify(document.getElementById('outer').scrollWidth == 340);
	verify(document.getElementById('outer').scrollHeight == 560);
}

html
{
//! <!doctype html>
//! <html><body style="margin:0;">
//!  <div id="outer" style="height:100px; width:150px; overflow:auto;">
//!   <div style="position:relative">
//!    <div style="float:left; height: 60px;">F</div>
//!    <div style="float:left; height: 60px;">F</div>
//!    <div style="clear: both; height: 40px;"></div>
//!    <div style="position:absolute; bottom: 0; width: 100px;">A</div>
//!   </div>
//!  </div>
//! </body></html>
}

test("Bottom aligned abspos pulled up during reflow #1")
{
	verify(document.getElementById('outer').scrollHeight == 100);
}

html
{
//! <!doctype html>
//! <html><body style="margin:0;">
//!  <div id="outer" style="height:100px; width:150px; overflow:auto;">
//!   <div style="position:relative">
//!    <div style="float:left; height: 60px;">F</div>
//!    <div style="float:left; height: 60px;">F</div>
//!    <div style="clear: both; height: 40px;"></div>
//!    <div style="position:absolute; bottom: -20px; width: 100px;">A</div>
//!   </div>
//!  </div>
//! </body></html>
}

test("Bottom aligned abspos pulled up during reflow #2")
{
	verify(document.getElementById('outer').scrollHeight == 120);
}
